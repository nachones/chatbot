<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control - Chatbot</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-robot"></i>
                    <span>Support AI</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <span class="nav-section-title">Principal</span>
                    <a href="#" class="nav-item active" data-page="dashboard">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" data-page="conversations">
                        <i class="fas fa-comments"></i>
                        <span>Conversaciones</span>
                    </a>
                    <a href="#" class="nav-item" data-page="leads">
                        <i class="fas fa-users"></i>
                        <span>Contactos</span>
                    </a>
                </div>

                <div class="nav-section">
                    <span class="nav-section-title">Chatbot</span>
                    <a href="#" class="nav-item" data-page="train">
                        <i class="fas fa-brain"></i>
                        <span>Entrenamiento</span>
                    </a>
                    <a href="#" class="nav-item" data-page="appearance">
                        <i class="fas fa-paint-brush"></i>
                        <span>Apariencia</span>
                    </a>
                    <a href="#" class="nav-item" data-page="prompts">
                        <i class="fas fa-bolt"></i>
                        <span>Respuestas Rápidas</span>
                    </a>
                    <a href="#" class="nav-item" data-page="functions">
                        <i class="fas fa-code"></i>
                        <span>Funciones</span>
                    </a>
                </div>

                <div class="nav-section">
                    <span class="nav-section-title">Configuración</span>
                    <a href="#" class="nav-item" data-page="integrations">
                        <i class="fas fa-plug"></i>
                        <span>Integraciones</span>
                    </a>
                    <a href="#" class="nav-item" data-page="settings">
                        <i class="fas fa-cog"></i>
                        <span>Ajustes</span>
                    </a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="avatar">A</div>
                    <div class="user-info">
                        <span class="user-name">Admin User</span>
                        <span class="user-role">Pro Plan</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Header -->
            <header class="top-header">
                <div class="header-left">
                    <h1 id="page-title">Dashboard</h1>
                </div>
                <div class="header-right">
                    <div class="chatbot-selector">
                        <button id="chatbot-current" class="btn-selector">
                            <span id="current-chatbot-name">Seleccionar Chatbot</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div id="chatbot-dropdown" class="dropdown-menu hidden">
                            <div id="chatbot-list">
                                <!-- Chatbots list will be populated here -->
                            </div>
                            <div class="dropdown-divider"></div>
                            <button id="btn-new-chatbot" class="dropdown-item create-new">
                                <i class="fas fa-plus"></i> Crear Nuevo Chatbot
                            </button>
                        </div>
                    </div>
                    <button class="btn-icon"><i class="fas fa-bell"></i></button>
                </div>
            </header>

            <!-- Page Content -->
            <div class="content-wrapper">

                <!-- Dashboard Page -->
                <div id="page-dashboard" class="page active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon blue"><i class="fas fa-comment-alt"></i></div>
                            <div class="stat-info">
                                <span class="stat-label">Mensajes Totales</span>
                                <span class="stat-value" id="total-messages">0</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon green"><i class="fas fa-users"></i></div>
                            <div class="stat-info">
                                <span class="stat-label">Conversaciones</span>
                                <span class="stat-value" id="total-conversations">0</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon purple"><i class="fas fa-brain"></i></div>
                            <div class="stat-info">
                                <span class="stat-label">Items Entrenados</span>
                                <span class="stat-value" id="training-count">0</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon orange"><i class="fas fa-address-book"></i></div>
                            <div class="stat-info">
                                <span class="stat-label">Leads Capturados</span>
                                <span class="stat-value" id="total-leads">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="charts-section">
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3>Actividad de Chat</h3>
                                <div class="chart-actions">
                                    <button class="chart-tab active" data-period="7d">7 días</button>
                                    <button class="chart-tab" data-period="30d">30 días</button>
                                </div>
                            </div>
                            <canvas id="chat-history-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Placeholder for other pages (will be populated dynamically or kept hidden) -->
                <div id="page-conversations" class="page">
                    <h2>Conversaciones</h2>
                    <p>Próximamente...</p>
                </div>
                <div id="page-leads" class="page">
                    <h2>Contactos</h2>
                    <p>Próximamente...</p>
                </div>
                <div id="page-train" class="page">
                    <!-- Training Content (Migrated from old dashboard) -->
                    <div class="section-header">
                        <h2>Entrenamiento del Chatbot</h2>
                        <p>Sube archivos o añade enlaces para que tu chatbot aprenda.</p>
                    </div>
                    <div class="training-grid">
                        <div class="upload-card">
                            <i class="fas fa-file-upload"></i>
                            <h3>Archivos</h3>
                            <p>PDF, DOCX, TXT</p>
                            <button class="btn-primary" onclick="document.getElementById('file-upload').click()">Subir
                                Archivos</button>
                            <input type="file" id="file-upload" multiple hidden>
                        </div>
                        <div class="upload-card">
                            <i class="fas fa-link"></i>
                            <h3>Sitio Web</h3>
                            <p>Rastrea tu web</p>
                            <button class="btn-secondary" id="btn-add-url">Añadir URL</button>
                        </div>
                        <div class="upload-card">
                            <i class="fas fa-align-left"></i>
                            <h3>Texto</h3>
                            <p>Entrada directa</p>
                            <button class="btn-secondary" id="btn-add-text">Escribir Texto</button>
                        </div>
                    </div>
                    <div class="training-list-section">
                        <h3>Fuentes de Datos</h3>
                        <div id="training-list" class="data-list"></div>
                    </div>
                </div>

                <!-- Settings Page -->
                <div id="page-settings" class="page">
                    <div class="settings-container">
                        <div class="settings-tabs">
                            <button class="tab-btn active" data-tab="general">General</button>
                            <button class="tab-btn" data-tab="model">Modelo</button>
                        </div>
                        <div class="settings-content">
                            <!-- Content will be migrated -->
                            <div class="form-group">
                                <label>Nombre del Chatbot</label>
                                <input type="text" class="form-control" id="chatbot-name-input">
                            </div>
                            <div class="form-group">
                                <label>Mensaje de Bienvenida</label>
                                <textarea class="form-control" id="welcome-message"></textarea>
                            </div>
                            <button class="btn-primary" id="save-chatbot-settings">Guardar Cambios</button>
                        </div>
                    </div>
                </div>

                <!-- Integrations / Deploy Page -->
                <div id="page-integrations" class="page">
                    <div class="deploy-container">
                        <div class="deploy-header">
                            <h2>Instalar Chatbot</h2>
                            <p>Copia y pega este código en tu sitio web para activar el chatbot.</p>
                        </div>
                        <div class="code-block-wrapper">
                            <div class="code-header">
                                <span>HTML</span>
                                <button class="btn-copy" id="copy-integration-code"><i class="fas fa-copy"></i>
                                    Copiar</button>
                            </div>
                            <pre><code id="integration-code" class="language-html">&lt;!-- Cargando código... --&gt;</code></pre>
                        </div>
                        <div class="deploy-steps">
                            <div class="step">
                                <div class="step-number">1</div>
                                <div class="step-text">Copia el código de arriba.</div>
                            </div>
                            <div class="step">
                                <div class="step-number">2</div>
                                <div class="step-text">Pégalo en el <code>&lt;head&gt;</code> o antes del cierre
                                    <code>&lt;/body&gt;</code> de tu HTML.</div>
                            </div>
                            <div class="step">
                                <div class="step-number">3</div>
                                <div class="step-text">¡Listo! El widget aparecerá en tu web.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Appearance Page -->
                <div id="page-appearance" class="page">
                    <h2>Apariencia</h2>
                    <p>Configuración visual (migración pendiente).</p>
                </div>

            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="new-chatbot-modal" class="modal">
        <div class="modal-content wizard-modal">
            <div class="modal-header">
                <h2>Crear Nuevo Chatbot</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Step 1: Basic Info -->
                <div class="wizard-step active" data-step="1">
                    <div class="form-group">
                        <label>Nombre del Chatbot</label>
                        <input type="text" id="new-chatbot-name" class="form-control"
                            placeholder="Ej. Mi Asistente de Soporte">
                    </div>
                    <div class="form-group">
                        <label>Descripción</label>
                        <textarea id="new-chatbot-description" class="form-control"
                            placeholder="¿Para qué servirá este chatbot?"></textarea>
                    </div>
                    <button class="btn-primary full-width" id="btn-step-1">Siguiente: Fuentes de Datos</button>
                </div>

                <!-- Step 2: Data Sources -->
                <div class="wizard-step hidden" data-step="2">
                    <h3>Entrena tu Chatbot</h3>
                    <p class="text-secondary">Sube archivos o añade una URL para que el bot aprenda.</p>

                    <div class="wizard-options">
                        <div class="option-card" id="wiz-opt-file">
                            <i class="fas fa-file-upload"></i>
                            <span>Subir Archivos</span>
                        </div>
                        <div class="option-card" id="wiz-opt-url">
                            <i class="fas fa-link"></i>
                            <span>Añadir URL</span>
                        </div>
                    </div>

                    <div id="wiz-upload-area" class="hidden mt-4">
                        <input type="file" id="wiz-file-input" class="form-control">
                    </div>
                    <div id="wiz-url-area" class="hidden mt-4">
                        <input type="url" id="wiz-url-input" class="form-control" placeholder="https://tu-sitio.com">
                    </div>

                    <div class="wizard-actions">
                        <button class="btn-secondary" id="btn-back-2">Atrás</button>
                        <button class="btn-primary" id="btn-step-2">Siguiente: Personalizar</button>
                    </div>
                </div>

                <!-- Step 3: Customization -->
                <div class="wizard-step hidden" data-step="3">
                    <h3>Personaliza la Apariencia</h3>
                    <div class="form-group">
                        <label>Color Principal</label>
                        <input type="color" id="wiz-color" class="form-control" value="#2563eb" style="height: 50px;">
                    </div>
                    <div class="form-group">
                        <label>Mensaje de Bienvenida</label>
                        <input type="text" id="wiz-welcome" class="form-control" value="¡Hola! ¿En qué puedo ayudarte?">
                    </div>

                    <div class="wizard-actions">
                        <button class="btn-secondary" id="btn-back-3">Atrás</button>
                        <button class="btn-primary" id="btn-step-3">Finalizar y Desplegar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/dashboard.js"></script>
</body>

</html>